# WanderLust - Technical Documentation

This document contains detailed technical information about the WanderLust application architecture, API endpoints, database schema, and implementation details.

## 📊 Database Schema

### User Model
```javascript
{
  email: String (required, unique),
  username: String (auto-generated by passport-local-mongoose)
}
```

### Listing Model
```javascript
{
  title: String (required),
  description: String,
  price: Number,
  image: { 
    url: String, 
    filename: String 
  },
  location: String,
  country: String,
  owner: ObjectId (ref: User),
  reviews: [ObjectId] (ref: Review)
}
```

### Review Model
```javascript
{
  comment: String,
  rating: Number (1-5),
  author: ObjectId (ref: User),
  createdAt: Date
}
```

## 🔧 API Endpoints

### Authentication Routes
- `GET /signup` - User registration form
- `POST /signup` - Create new user account
- `GET /login` - User login form
- `POST /login` - Authenticate user
- `GET /logout` - Logout user

### Listing Routes
- `GET /listings` - View all listings with filters
- `GET /listings/new` - Create new listing form
- `POST /listings` - Create new listing
- `GET /listings/:id` - View specific listing with reviews
- `GET /listings/:id/edit` - Edit listing form
- `PUT /listings/:id` - Update listing
- `DELETE /listings/:id` - Delete listing

### Review Routes
- `POST /listings/:id/reviews` - Add review to listing
- `DELETE /listings/:id/reviews/:reviewId` - Delete review

## 🔒 Security Features

### Authentication & Authorization
- **HTTP-only Cookies**: Secure session management
- **Password Hashing**: bcrypt-based password security
- **Session Management**: Express-session with secure configuration
- **Protected Routes**: Middleware-based route protection
- **User Authorization**: Only listing owners can edit/delete their listings

### Input Validation & Sanitization
- **Joi Schema Validation**: Input validation for all forms
- **XSS Prevention**: Input sanitization
- **CSRF Protection**: Built-in Express security
- **SQL Injection Prevention**: Mongoose ODM protection

### File Upload Security
- **File Type Validation**: Only image files allowed
- **File Size Limits**: Prevents large file uploads
- **Cloud Storage**: Secure cloud storage with Cloudinary
- **Filename Sanitization**: Safe filename handling

## 🏗️ Application Architecture

### Directory Structure
```
wanderlust/
├── app.js                 # Main application file
├── package.json           # Dependencies and scripts
├── models/               # Database models
│   ├── listing.js
│   ├── review.js
│   └── user.js
├── routes/               # Route handlers
│   ├── listing.js
│   ├── review.js
│   └── user.js
├── controllers/          # Business logic
│   ├── listingController.js
│   ├── reviewController.js
│   └── userController.js
├── middleware.js         # Custom middleware
├── utils/               # Utility functions
│   ├── expressError.js
│   └── wrapAsync.js
├── views/               # EJS templates
│   ├── layouts/
│   ├── includes/
│   ├── listings/
│   └── users/
├── public/              # Static assets
│   ├── css/
│   ├── js/
│   └── images/
└── init/               # Initialization scripts
    ├── index.js
    └── data.js
```

### Middleware Stack
1. **Static Files**: Serve static assets
2. **Body Parser**: Parse request bodies
3. **Method Override**: Handle PUT/DELETE requests
4. **Session**: User session management
5. **Flash Messages**: User feedback
6. **Passport**: Authentication
7. **Local Variables**: Make user data available to templates
8. **Routes**: Application routes
9. **Error Handling**: 404 and error middleware

## 🎨 Frontend Architecture

### Template Engine
- **EJS**: Server-side templating
- **Layout System**: Boilerplate layout with partials
- **Component Structure**: Modular template components

### CSS Architecture
- **Bootstrap 5**: Responsive grid system
- **Custom CSS**: Modern styling with gradients
- **Responsive Design**: Mobile-first approach
- **CSS Variables**: Consistent color scheme

### JavaScript Features
- **Interactive Forms**: Real-time validation
- **Tax Toggle**: Dynamic price display
- **Smooth Animations**: CSS transitions and transforms

## 🚀 Deployment Configuration

### Environment Variables
```env
NODE_ENV=production
PORT=3000
CLOUD_NAME=your_cloudinary_cloud_name
CLOUD_API_KEY=your_cloudinary_api_key
CLOUD_API_SECRET=your_cloudinary_api_secret
MONGODB_URI=your_mongodb_connection_string
SESSION_SECRET=your_session_secret
```

### Production Dependencies
- **Node.js**: v14 or higher
- **MongoDB**: Database server
- **Cloudinary**: Image storage

### Deployment Commands
```bash
# Install dependencies
npm install --production

# Start production server
npm start

# Environment setup
export NODE_ENV=production
```

## 🔧 Development Tools

### Development Dependencies
- **Nodemon**: Auto-restart development server
- **Dotenv**: Environment variable management

### Development Scripts
```json
{
  "scripts": {
    "start": "node app.js",
    "dev": "nodemon app.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  }
}
```

## 📱 Responsive Design Implementation

### Breakpoints
- **Mobile**: < 768px
- **Tablet**: 768px - 1024px
- **Desktop**: > 1024px

### Mobile Optimizations
- **Touch Targets**: Minimum 44px touch areas
- **Font Sizes**: Readable on small screens
- **Navigation**: Collapsible mobile menu
- **Forms**: Mobile-optimized input fields

## 🔍 Performance Optimizations

### Database Optimizations
- **Indexing**: Proper database indexes
- **Query Optimization**: Efficient MongoDB queries
- **Connection Pooling**: Optimized database connections

### Frontend Optimizations
- **Image Optimization**: Compressed images
- **CSS Minification**: Reduced file sizes
- **JavaScript Bundling**: Optimized script loading
- **Caching**: Browser and server-side caching

## 🧪 Testing Strategy

### Manual Testing
- **User Authentication**: Login/logout flows
- **CRUD Operations**: Create, read, update, delete listings
- **Review System**: Add and delete reviews
- **Responsive Design**: Cross-device testing

### Error Handling
- **404 Errors**: Custom error pages
- **Validation Errors**: User-friendly error messages
- **Database Errors**: Graceful error handling
- **File Upload Errors**: Upload failure handling

## 🔄 Data Flow Diagrams

### User Registration Flow
```
User Input → Validation → Password Hashing → Database Save → Session Creation → Redirect
```

### Listing Creation Flow
```
Form Input → Validation → Image Upload → Database Save → Redirect to Listing
```

### Review System Flow
```
Review Input → Validation → Database Save → Update Listing → Redirect
```

## 📈 Scalability Considerations

### Database Scaling
- **Indexing Strategy**: Proper database indexes
- **Query Optimization**: Efficient queries
- **Connection Management**: Connection pooling

### Application Scaling
- **Stateless Design**: Session management
- **Modular Architecture**: Component-based structure
- **Caching Strategy**: Redis integration potential

### Infrastructure Scaling
- **Load Balancing**: Multiple server instances
- **CDN Integration**: Static asset delivery
- **Database Clustering**: MongoDB replica sets

---

*This technical documentation provides comprehensive information about the WanderLust application architecture and implementation details.* 
 ### Owner - *Sourabh Kumar*
