<% layout('/layouts/boilerplate.ejs') -%>
<div class="auth-container" style="max-width: 800px;">
  <h3>
    <i class="fa-solid fa-plus-circle me-2"></i>
    Create a New Listing
  </h3>
  
  <form
    class="needs-validation"
    action="/listings"
    method="post"
    novalidate
    enctype="multipart/form-data"
  >
    <div class="mb-4">
      <label for="title" class="form-label">
        <i class="fa-solid fa-heading me-2"></i>Title
      </label>
      <input
        type="text"
        name="listing[title]"
        id="title"
        placeholder="Add a catchy title for your listing"
        class="form-control"
        required
      />
      <div class="valid-feedback">Title looks good!</div>
      <div class="invalid-feedback">Please enter a title for your listing</div>
    </div>

    <div class="mb-4">
      <label for="description" class="form-label">
        <i class="fa-solid fa-align-left me-2"></i>Description
      </label>
      <textarea
        class="form-control"
        id="description"
        name="listing[description]"
        placeholder="Describe your property, amenities, and what makes it special"
        rows="4"
        required
      ></textarea>
      <div class="invalid-feedback">Please provide a description</div>
    </div>

    <div class="row">
      <div class="mb-4 col-md-6">
        <label for="price" class="form-label">
          <i class="fa-solid fa-indian-rupee-sign me-2"></i>Price per Night
        </label>
        <input
          type="number"
          name="listing[price]"
          id="price"
          placeholder="e.g., 1500"
          class="form-control"
          min="0"
          required
        />
        <div class="invalid-feedback">Please enter a valid price</div>
      </div>
      
      <div class="mb-4 col-md-6">
        <label for="image" class="form-label">
          <i class="fa-solid fa-image me-2"></i>Property Image
        </label>
        <input
          type="file"
          name="listing[image]"
          id="image"
          class="form-control"
          accept="image/*"
        />
        <input
          type="hidden"
          name="listing[image][filename]"
          value="listing-image"
        />
        <small class="text-muted">
          <i class="fa-solid fa-info-circle me-1"></i>
          If no image is provided, a default image will be used
        </small>
      </div>
    </div>

    <div class="row">
      <div class="mb-4 col-md-6">
        <label for="location" class="form-label">
          <i class="fa-solid fa-map-marker-alt me-2"></i>Location
        </label>
        <input
          class="form-control"
          type="text"
          name="listing[location]"
          id="location"
          placeholder="e.g., Jaipur, Rajasthan"
          required
        />
        <div class="invalid-feedback">Please enter a valid location</div>
      </div>

      <div class="mb-4 col-md-6">
        <label for="country" class="form-label">
          <i class="fa-solid fa-flag me-2"></i>Country
        </label>
        <input
          class="form-control"
          type="text"
          name="listing[country]"
          id="country"
          placeholder="e.g., India"
          required
        />
        <div class="invalid-feedback">Please enter a valid country</div>
      </div>
    </div>

    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
      <a href="/listings" class="btn btn-outline-secondary me-md-2">
        <i class="fa-solid fa-arrow-left me-2"></i>Cancel
      </a>
      <button class="btn btn-success add-btn" type="submit">
        <i class="fa-solid fa-plus me-2"></i>Create Listing
      </button>
    </div>
  </form>
</div>

<script>
// Form validation
(function () {
  'use strict'
  var forms = document.querySelectorAll('.needs-validation')
  Array.prototype.slice.call(forms).forEach(function (form) {
    form.addEventListener('submit', function (event) {
      if (!form.checkValidity()) {
        event.preventDefault()
        event.stopPropagation()
      }
      form.classList.add('was-validated')
    }, false)
  })
})()
</script>
